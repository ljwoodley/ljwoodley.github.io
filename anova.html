<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>One-Way Analysis of Variance</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Laurence James-Woodley</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Blog.html">BLOG</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ljwoodley">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/laurencejwoodley/">
    <span class="fa fa-linkedin fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="mailto:laurencejwoodley@gmail.com">
    <span class="fas fa fas fa-envelope fa-2x"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">One-Way Analysis of Variance</h1>

</div>


<div id="introduction" class="section level3">
<h3>Introduction</h3>
<p>When there are multiple means to compare it is incorrect to use multiple two independent sample t-tests as this increases the chances of making a Type I error. The One-Way Analysis of Variance (ANOVA), also known as a completely randomized design, is used to determine whether there is a statistically significant difference between the means of two or more independent groups, i.e., the difference in means between groups is too large to be the product of random selection.</p>
</div>
<div id="data" class="section level3">
<h3>Data</h3>
<p>This post will display the necessary steps in performing the One-Way ANOVA test using data obtained from an experiment conducted by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4925378/">Bhatnagar and Mehta</a> to compare the effectiveness of five different mosquito patches in reducing man mosquito contact.The data contains 30 subjects for each group and for each subject, the number of mosquito bites per hour was recorded. The dependent variable is the number of mosquito bites and the independent variable is the mosquito treatment patch. This experiment can also be described as a single-factor experiment with five levels of the factor, where factor is the mosquito patch and the five levels are the five different patch types.</p>
<pre class="r"><code>patch &lt;- read.csv(&quot;data/mosquito.csv&quot;)
summary_stats &lt;- patch %&gt;% 
                 group_by(Treatment=treatment) %&gt;% 
                 summarise(&#39;Sample Size&#39;=n(),Mean=round(mean(number_bites),2),
                           &#39;Standard Deviation&#39;=round(sd(number_bites),2))
kable(summary_stats, align=&quot;c&quot;,&quot;html&quot;,caption = &quot;Table 1: Summary Statistics&quot;) %&gt;% 
  kable_styling(bootstrap_options=&quot;bordered&quot;,full_width=F, position=&quot;center&quot;) </code></pre>
<table class="table table-bordered" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Table 1: Summary Statistics
</caption>
<thead>
<tr>
<th style="text-align:center;">
Treatment
</th>
<th style="text-align:center;">
Sample Size
</th>
<th style="text-align:center;">
Mean
</th>
<th style="text-align:center;">
Standard Deviation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
30
</td>
<td style="text-align:center;">
7.90
</td>
<td style="text-align:center;">
3.37
</td>
</tr>
<tr>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
30
</td>
<td style="text-align:center;">
8.13
</td>
<td style="text-align:center;">
3.46
</td>
</tr>
<tr>
<td style="text-align:center;">
C
</td>
<td style="text-align:center;">
30
</td>
<td style="text-align:center;">
8.03
</td>
<td style="text-align:center;">
3.01
</td>
</tr>
<tr>
<td style="text-align:center;">
D
</td>
<td style="text-align:center;">
30
</td>
<td style="text-align:center;">
6.33
</td>
<td style="text-align:center;">
3.12
</td>
</tr>
<tr>
<td style="text-align:center;">
E
</td>
<td style="text-align:center;">
30
</td>
<td style="text-align:center;">
5.37
</td>
<td style="text-align:center;">
3.07
</td>
</tr>
</tbody>
</table>
</div>
<div id="model-assumptions" class="section level3">
<h3>Model Assumptions</h3>
<p>For the ANOVA test to be valid there are three main assumptions about the residuals in the model that must be satisfied:</p>
<ul>
<li><p>Independence - This assumption is of severe importance as it can render all results invalid if it is violated. This was controlled by the scientists during the planning and execution phases of the experiment.</p></li>
<li><p>Constant Variance - We can determine if constant variance is violated by plotting the residuals vs fitted values and by using a statistical test such as the modified Levene test which is robust to departures from normality. On inspecting Figure 1 we see that there is no obvious pattern (funnel shape) in the plot to indicate that non-constant variance is present. Additionally, for the modified Levene test, the null hypothesis of constant variance was accepted as p-value &gt; 0.05</p></li>
<li><p>Normality - The residuals should follow a normal distribution. However, the analysis of variance is robust to the normality assumption and moderate departures from normality aren’t significant. This is especially true for large samples and when the sample size for each group is equal. On inspecting the Q-Q Plot in Figure 1 we observe moderate departure from normality but this is not serious enough to suggest performing a transformation on the data.</p></li>
</ul>
<pre class="r"><code>model &lt;- lm(number_bites~treatment, data=patch)
par(mfrow=c(1,2))
plot(model,which=c(1,2), labels.id = F)
box(&quot;outer&quot;,lty=&quot;solid&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-2-1.png" alt="Figure 1: Residual Analysis" width="672" />
<p class="caption">
Figure 1: Residual Analysis
</p>
</div>
<p>Now that we have confirmed that remedial measures are not needed we will create the ANOVA table.</p>
</div>
<div id="ad-hoc-analysis" class="section level3">
<h3>Ad-Hoc Analysis</h3>
<p>The main goal of One-Way ANOVA is to determine whether the means of all groups are equal for the the different levels of one factor. Thus, we wish to test if the mean number of mosquito bites is the same for each of the five patches. <span class="math display">\[H_0: \mu_1= \mu_2=\mu_3=\mu_4=\mu_5\]</span> <span class="math display">\[H_a: \mu_i\neq\mu_j \ for \ some \ unique \ i, j\]</span></p>
<p>We will conduct this test at a significance level of 0.05. The results of the ANOVA test is shown below.</p>
<pre class="r"><code>options(knitr.kable.NA=&#39;&#39;)
kable(anova(model),align=&quot;c&quot;, digits = 3,&quot;html&quot;)%&gt;% 
  kable_styling(bootstrap_options=&quot;basic&quot;,full_width=F) </code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Df
</th>
<th style="text-align:center;">
Sum Sq
</th>
<th style="text-align:center;">
Mean Sq
</th>
<th style="text-align:center;">
F value
</th>
<th style="text-align:center;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
184.646
</td>
<td style="text-align:center;">
46.162
</td>
<td style="text-align:center;">
4.48
</td>
<td style="text-align:center;">
0.002
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:center;">
145
</td>
<td style="text-align:center;">
1494.146
</td>
<td style="text-align:center;">
10.304
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
<p>There are two ways to determine whether to reject or accept the null hypothesis. The first is to use the F statistic (<span class="math inline">\(F^*\)</span>) and compare it to the appropriate percentile of the F-distribution. If <span class="math inline">\(F^*\)</span> &gt; <span class="math inline">\(F_{(1-\alpha, k-1, n-k)}\)</span> where <span class="math inline">\(k\)</span> = 5(number of groups) and <span class="math inline">\(n\)</span> is the sample size, we reject the null hypothesis. We see that <span class="math inline">\(F_{(.95,4,145)}\)</span> = 2.43. Because <span class="math inline">\(F^*\)</span> = 4.48 &gt; 2.43, we reject the null hypothesis.</p>
<p>The second method would be to compare the p-value to the significance level. If the p-value is less than the significance level the null hypothesis is rejected. As p-value = 0.002 &lt; 0.05, we reject the null hypothesis.</p>
<p>Both methods rejected the null hypothesis. Thus, we we can conclude that at a significance level of 0.05, there are differences in the mean number of mosquito bites for the five patches.</p>
</div>
<div id="post-hoc-analysis" class="section level3">
<h3>Post-Hoc Analysis</h3>
<p>Now that we have determined that there are differences in the mean number of mosquito bites per treatment, the next step is to determine which means differ. This can be achieved by comparing every mean in the dataset with every other mean in the dataset, also known as pairwise multiple comparisons. As there are 5 groups there will be <span class="math inline">\(5(5-1)/2 = 10\)</span> pairwise comparisons.</p>
<p>Now suppose we construct a 95% confidence interval in each case. Then the error rate(<span class="math inline">\(\alpha\)</span>) is 0.05 for each interval, so there is a 5% chance of making a wrong conclusion in each of the 10 intervals. Here we are controlling the comparison error rate at 0.05 so that each interval has the same error rate. Thus, as we are performing 10 comparisons the overall experiment error rate, which is the probability of making at least one incorrect conclusion amongst the set of intervals, will be larger than 0.05.</p>
<p>There are various multiple comparison procedures such as Fisher’s LSD , Scheffe’s method and the Bonferroni method but we shall use the Tukey HSD procedure as it has an experiment error rate of <span class="math inline">\(\alpha\)</span> and a comparison error rate less than <span class="math inline">\(\alpha\)</span>. As the experiment error rate is fixed at <span class="math inline">\(\alpha=0.05\)</span> we will be making simultaneous 95% confidence intervals instead of individual 95% confidence intervals. Thus, the probability of making at least one incorrect conclusion amongst the 10 intervals will be 0.05.</p>
<pre class="r"><code>tukey.test &lt;- TukeyHSD(aov(model),conf.level=.95)
plot(tukey.test)</code></pre>
<div class="figure" style="text-align: center">
<img src="anova_files/figure-html/unnamed-chunk-4-1.png" alt="Figure 3" width="672" />
<p class="caption">
Figure 3
</p>
</div>
<p>Figure 3 shows the confidence intervals for the difference between pairs of means. If the interval contains zero then the difference between any two means is not statistically significant. We see that the confidence intervals for the difference between the means of Patch E and Patch A, Patch E and Path B and Patch E and Patch C do not contain zero. Thus, these three pairs have means which are significantly different. To determine if there is a significant difference between the means of three of more groups we will list the mean number of bites in ascending order and draw lines beneath means that are not significantly different.</p>
<div class="figure">
<img src="images/Capture.JPG" />

</div>
<p>Based on the above result we see that there is no significant difference in the mean number of mosquito bites between patches E and D. There is also no significant difference between patches A, B, C and D. Thus, we can conclude that patches E and D are the most effective mosquito repellents.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
